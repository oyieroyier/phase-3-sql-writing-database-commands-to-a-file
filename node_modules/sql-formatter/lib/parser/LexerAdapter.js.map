{"version":3,"file":"LexerAdapter.js","names":["LexerAdapter","tokenize","chunk","_info","input","index","tokens","token","lineColFromIndex","start","line","col","text","name","TokenType"],"sources":["../../src/parser/LexerAdapter.ts"],"sourcesContent":["import { lineColFromIndex } from 'src/lexer/lineColFromIndex';\nimport { Token, TokenType } from 'src/lexer/token';\n\n// Nearly type definitions say that Token must have a value field,\n// which however is wrong.  Instead Nearley expects a text field.\ntype NearleyToken = Token & { value: string };\n\nexport default class LexerAdapter {\n  private index = 0;\n  private tokens: Token[] = [];\n  private input = '';\n\n  constructor(private tokenize: (chunk: string) => Token[]) {}\n\n  reset(chunk: string, _info: any) {\n    this.input = chunk;\n    this.index = 0;\n    this.tokens = this.tokenize(chunk);\n  }\n\n  next(): NearleyToken | undefined {\n    return this.tokens[this.index++] as NearleyToken | undefined;\n  }\n\n  save(): any {}\n\n  formatError(token: NearleyToken) {\n    const { line, col } = lineColFromIndex(this.input, token.start);\n    return `Parse error at token: ${token.text} at line ${line} column ${col}`;\n  }\n\n  has(name: string): boolean {\n    return name in TokenType;\n  }\n}\n"],"mappings":";;;;;;;AAAA;;AACA;;;;;;;;;;IAMqBA,Y;EAKnB,sBAAoBC,QAApB,EAA0D;IAAA;;IAAA,KAAtCA,QAAsC,GAAtCA,QAAsC;;IAAA,+BAJ1C,CAI0C;;IAAA,gCAHhC,EAGgC;;IAAA,+BAF1C,EAE0C;EAAE;;;;WAE5D,eAAMC,KAAN,EAAqBC,KAArB,EAAiC;MAC/B,KAAKC,KAAL,GAAaF,KAAb;MACA,KAAKG,KAAL,GAAa,CAAb;MACA,KAAKC,MAAL,GAAc,KAAKL,QAAL,CAAcC,KAAd,CAAd;IACD;;;WAED,gBAAiC;MAC/B,OAAO,KAAKI,MAAL,CAAY,KAAKD,KAAL,EAAZ,CAAP;IACD;;;WAED,gBAAY,CAAE;;;WAEd,qBAAYE,KAAZ,EAAiC;MAC/B,wBAAsB,IAAAC,mCAAA,EAAiB,KAAKJ,KAAtB,EAA6BG,KAAK,CAACE,KAAnC,CAAtB;MAAA,IAAQC,IAAR,qBAAQA,IAAR;MAAA,IAAcC,GAAd,qBAAcA,GAAd;;MACA,uCAAgCJ,KAAK,CAACK,IAAtC,sBAAsDF,IAAtD,qBAAqEC,GAArE;IACD;;;WAED,aAAIE,IAAJ,EAA2B;MACzB,OAAOA,IAAI,IAAIC,gBAAf;IACD"}