{"version":3,"file":"n1ql.formatter.js","names":["reservedSelect","expandPhrases","reservedCommands","reservedSetOperations","reservedJoins","reservedPhrases","N1qlFormatter","Tokenizer","reservedDependentClauses","supportsXor","reservedKeywords","keywords","reservedFunctionNames","functions","stringTypes","identTypes","extraParens","paramTypes","positional","numbered","named","lineCommentTypes","operators","Formatter"],"sources":["../../../src/languages/n1ql/n1ql.formatter.ts"],"sourcesContent":["import { expandPhrases } from 'src/expandPhrases';\nimport Formatter from 'src/formatter/Formatter';\nimport Tokenizer from 'src/lexer/Tokenizer';\nimport { functions } from './n1ql.functions';\nimport { keywords } from './n1ql.keywords';\n\nconst reservedSelect = expandPhrases(['SELECT [ALL | DISTINCT]']);\n\nconst reservedCommands = expandPhrases([\n  // queries\n  'WITH',\n  'FROM',\n  'WHERE',\n  'GROUP BY',\n  'HAVING',\n  'WINDOW',\n  'PARTITION BY',\n  'ORDER BY',\n  'LIMIT',\n  'OFFSET',\n  // Data manipulation\n  // - insert:\n  'INSERT INTO',\n  'VALUES',\n  // - update:\n  'UPDATE',\n  'SET',\n  // - delete:\n  'DELETE FROM',\n  // - merge:\n  'MERGE INTO',\n  'WHEN [NOT] MATCHED THEN',\n  'UPDATE SET',\n  'INSERT',\n  // https://docs.couchbase.com/server/current/n1ql/n1ql-language-reference/reservedwords.html\n  'ADVISE',\n  'ALTER INDEX',\n  'BEGIN TRANSACTION',\n  'BUILD INDEX',\n  'COMMIT TRANSACTION',\n  'CREATE COLLECTION',\n  'CREATE FUNCTION',\n  'CREATE INDEX',\n  'CREATE PRIMARY INDEX',\n  'CREATE SCOPE',\n  'DROP COLLECTION',\n  'DROP FUNCTION',\n  'DROP INDEX',\n  'DROP PRIMARY INDEX',\n  'DROP SCOPE',\n  'EXECUTE',\n  'EXECUTE FUNCTION',\n  'EXPLAIN',\n  'GRANT',\n  'INFER',\n  'PREPARE',\n  'RETURNING',\n  'REVOKE',\n  'ROLLBACK TRANSACTION',\n  'SAVEPOINT',\n  'SET TRANSACTION',\n  'UPDATE STATISTICS',\n  'UPSERT',\n  // other\n  'LET',\n  'NEST',\n  'SET CURRENT SCHEMA',\n  'SET SCHEMA',\n  'SHOW',\n  'UNNEST',\n  'USE KEYS',\n]);\n\nconst reservedSetOperations = expandPhrases(['UNION [ALL]', 'EXCEPT [ALL]', 'INTERSECT [ALL]']);\n\nconst reservedJoins = expandPhrases(['JOIN', '{LEFT | RIGHT} [OUTER] JOIN', 'INNER JOIN']);\n\nconst reservedPhrases = expandPhrases(['{ROWS | RANGE | GROUPS} BETWEEN']);\n\n// For reference: http://docs.couchbase.com.s3-website-us-west-1.amazonaws.com/server/6.0/n1ql/n1ql-language-reference/index.html\nexport default class N1qlFormatter extends Formatter {\n  tokenizer() {\n    return new Tokenizer({\n      reservedCommands,\n      reservedSelect,\n      reservedSetOperations,\n      reservedJoins,\n      reservedDependentClauses: ['WHEN', 'ELSE'],\n      reservedPhrases,\n      supportsXor: true,\n      reservedKeywords: keywords,\n      reservedFunctionNames: functions,\n      // NOTE: single quotes are actually not supported in N1QL,\n      // but we support them anyway as all other SQL dialects do,\n      // which simplifies writing tests that are shared between all dialects.\n      stringTypes: ['\"\"-bs', \"''-bs\"],\n      identTypes: ['``'],\n      extraParens: ['[]', '{}'],\n      paramTypes: { positional: true, numbered: ['$'], named: ['$'] },\n      lineCommentTypes: ['#', '--'],\n      operators: ['%', '==', ':', '||'],\n    });\n  }\n}\n"],"mappings":";;;;;;;;;AAAA;;AACA;;AACA;;AACA;;AACA;;;;;;;;;;;;;;;;;;;;;;;;AAEA,IAAMA,cAAc,GAAG,IAAAC,4BAAA,EAAc,CAAC,yBAAD,CAAd,CAAvB;AAEA,IAAMC,gBAAgB,GAAG,IAAAD,4BAAA,EAAc,CACrC;AACA,MAFqC,EAGrC,MAHqC,EAIrC,OAJqC,EAKrC,UALqC,EAMrC,QANqC,EAOrC,QAPqC,EAQrC,cARqC,EASrC,UATqC,EAUrC,OAVqC,EAWrC,QAXqC,EAYrC;AACA;AACA,aAdqC,EAerC,QAfqC,EAgBrC;AACA,QAjBqC,EAkBrC,KAlBqC,EAmBrC;AACA,aApBqC,EAqBrC;AACA,YAtBqC,EAuBrC,yBAvBqC,EAwBrC,YAxBqC,EAyBrC,QAzBqC,EA0BrC;AACA,QA3BqC,EA4BrC,aA5BqC,EA6BrC,mBA7BqC,EA8BrC,aA9BqC,EA+BrC,oBA/BqC,EAgCrC,mBAhCqC,EAiCrC,iBAjCqC,EAkCrC,cAlCqC,EAmCrC,sBAnCqC,EAoCrC,cApCqC,EAqCrC,iBArCqC,EAsCrC,eAtCqC,EAuCrC,YAvCqC,EAwCrC,oBAxCqC,EAyCrC,YAzCqC,EA0CrC,SA1CqC,EA2CrC,kBA3CqC,EA4CrC,SA5CqC,EA6CrC,OA7CqC,EA8CrC,OA9CqC,EA+CrC,SA/CqC,EAgDrC,WAhDqC,EAiDrC,QAjDqC,EAkDrC,sBAlDqC,EAmDrC,WAnDqC,EAoDrC,iBApDqC,EAqDrC,mBArDqC,EAsDrC,QAtDqC,EAuDrC;AACA,KAxDqC,EAyDrC,MAzDqC,EA0DrC,oBA1DqC,EA2DrC,YA3DqC,EA4DrC,MA5DqC,EA6DrC,QA7DqC,EA8DrC,UA9DqC,CAAd,CAAzB;AAiEA,IAAME,qBAAqB,GAAG,IAAAF,4BAAA,EAAc,CAAC,aAAD,EAAgB,cAAhB,EAAgC,iBAAhC,CAAd,CAA9B;AAEA,IAAMG,aAAa,GAAG,IAAAH,4BAAA,EAAc,CAAC,MAAD,EAAS,6BAAT,EAAwC,YAAxC,CAAd,CAAtB;AAEA,IAAMI,eAAe,GAAG,IAAAJ,4BAAA,EAAc,CAAC,iCAAD,CAAd,CAAxB,C,CAEA;;IACqBK,a;;;;;;;;;;;;;WACnB,qBAAY;MACV,OAAO,IAAIC,qBAAJ,CAAc;QACnBL,gBAAgB,EAAhBA,gBADmB;QAEnBF,cAAc,EAAdA,cAFmB;QAGnBG,qBAAqB,EAArBA,qBAHmB;QAInBC,aAAa,EAAbA,aAJmB;QAKnBI,wBAAwB,EAAE,CAAC,MAAD,EAAS,MAAT,CALP;QAMnBH,eAAe,EAAfA,eANmB;QAOnBI,WAAW,EAAE,IAPM;QAQnBC,gBAAgB,EAAEC,eARC;QASnBC,qBAAqB,EAAEC,eATJ;QAUnB;QACA;QACA;QACAC,WAAW,EAAE,CAAC,OAAD,EAAU,OAAV,CAbM;QAcnBC,UAAU,EAAE,CAAC,IAAD,CAdO;QAenBC,WAAW,EAAE,CAAC,IAAD,EAAO,IAAP,CAfM;QAgBnBC,UAAU,EAAE;UAAEC,UAAU,EAAE,IAAd;UAAoBC,QAAQ,EAAE,CAAC,GAAD,CAA9B;UAAqCC,KAAK,EAAE,CAAC,GAAD;QAA5C,CAhBO;QAiBnBC,gBAAgB,EAAE,CAAC,GAAD,EAAM,IAAN,CAjBC;QAkBnBC,SAAS,EAAE,CAAC,GAAD,EAAM,IAAN,EAAY,GAAZ,EAAiB,IAAjB;MAlBQ,CAAd,CAAP;IAoBD;;;;EAtBwCC,sB"}