{"version":3,"file":"NestedComment.js","names":["START","MIDDLE","END","NestedComment","input","result","match","nestLevel","matchSection","regex","lastIndex","matches","exec","length"],"sources":["../../src/lexer/NestedComment.ts"],"sourcesContent":["/* eslint-disable no-cond-assign */\nimport { RegExpLike } from 'src/lexer/TokenizerEngine';\n\nconst START = /\\/\\*/uy; // matches: /*\nconst MIDDLE = /([^/*]|\\*[^/]|\\/[^*])+/uy; // matches text NOT containing /* or */\nconst END = /\\*\\//uy; // matches: */\n\n/**\n * An object mimicking a regular expression,\n * for matching nested block-comments.\n */\nexport class NestedComment implements RegExpLike {\n  public lastIndex: number = 0;\n\n  public exec(input: string): string[] | null {\n    let result = '';\n    let match: string | null;\n    let nestLevel = 0;\n\n    if ((match = this.matchSection(START, input))) {\n      result += match;\n      nestLevel++;\n    } else {\n      return null;\n    }\n\n    while (nestLevel > 0) {\n      if ((match = this.matchSection(START, input))) {\n        result += match;\n        nestLevel++;\n      } else if ((match = this.matchSection(END, input))) {\n        result += match;\n        nestLevel--;\n      } else if ((match = this.matchSection(MIDDLE, input))) {\n        result += match;\n      } else {\n        return null;\n      }\n    }\n\n    return [result];\n  }\n\n  private matchSection(regex: RegExp, input: string): string | null {\n    regex.lastIndex = this.lastIndex;\n    const matches = regex.exec(input);\n    if (matches) {\n      this.lastIndex += matches[0].length;\n    }\n    return matches ? matches[0] : null;\n  }\n}\n"],"mappings":";;;;;;;;;;;;;;;AAAA;AAGA,IAAMA,KAAK,4BAAX,C,CAAwB;;AACxB,IAAMC,MAAM,+FAAZ,C,CAA2C;;AAC3C,IAAMC,GAAG,4BAAT,C,CAAsB;;AAEtB;AACA;AACA;AACA;;IACaC,a;;;;uCACgB,C;;;;;WAE3B,cAAYC,KAAZ,EAA4C;MAC1C,IAAIC,MAAM,GAAG,EAAb;MACA,IAAIC,KAAJ;MACA,IAAIC,SAAS,GAAG,CAAhB;;MAEA,IAAKD,KAAK,GAAG,KAAKE,YAAL,CAAkBR,KAAlB,EAAyBI,KAAzB,CAAb,EAA+C;QAC7CC,MAAM,IAAIC,KAAV;QACAC,SAAS;MACV,CAHD,MAGO;QACL,OAAO,IAAP;MACD;;MAED,OAAOA,SAAS,GAAG,CAAnB,EAAsB;QACpB,IAAKD,KAAK,GAAG,KAAKE,YAAL,CAAkBR,KAAlB,EAAyBI,KAAzB,CAAb,EAA+C;UAC7CC,MAAM,IAAIC,KAAV;UACAC,SAAS;QACV,CAHD,MAGO,IAAKD,KAAK,GAAG,KAAKE,YAAL,CAAkBN,GAAlB,EAAuBE,KAAvB,CAAb,EAA6C;UAClDC,MAAM,IAAIC,KAAV;UACAC,SAAS;QACV,CAHM,MAGA,IAAKD,KAAK,GAAG,KAAKE,YAAL,CAAkBP,MAAlB,EAA0BG,KAA1B,CAAb,EAAgD;UACrDC,MAAM,IAAIC,KAAV;QACD,CAFM,MAEA;UACL,OAAO,IAAP;QACD;MACF;;MAED,OAAO,CAACD,MAAD,CAAP;IACD;;;WAED,sBAAqBI,KAArB,EAAoCL,KAApC,EAAkE;MAChEK,KAAK,CAACC,SAAN,GAAkB,KAAKA,SAAvB;MACA,IAAMC,OAAO,GAAGF,KAAK,CAACG,IAAN,CAAWR,KAAX,CAAhB;;MACA,IAAIO,OAAJ,EAAa;QACX,KAAKD,SAAL,IAAkBC,OAAO,CAAC,CAAD,CAAP,CAAWE,MAA7B;MACD;;MACD,OAAOF,OAAO,GAAGA,OAAO,CAAC,CAAD,CAAV,GAAgB,IAA9B;IACD"}